# D2R法师刷Pindle配置指南 (1920x1080)

## 前置准备

### 1. 角色要求
- **职业**: 法师 (Sorceress)
- **等级**: 建议85+
- **技能**: 传送 (Teleport) + 闪电/暴风雪/火球等主攻击技能
- **装备**: 
  - 建议有传送法杖或谜团
  - 足够的FCR (Faster Cast Rate)
  - 抗性装备（Pindle有物理伤害）
- **任务**: 必须完成第五章安亚救援（解锁红门）

### 2. 游戏设置
- **分辨率**: 1920x1080
- **窗口模式**: 全屏或窗口化全屏
- **图形模式**: 重制版画面

## 快速开始

### 步骤1: 获取准确坐标
```bash
python coordinate_helper.py
```

按数字键记录以下坐标（移动鼠标到目标位置后按键）：
1. 大厅 - "创建游戏"按钮
2. 大厅 - 游戏名称输入框
3. 大厅 - 密码输入框（可选）
4. 大厅 - "开始游戏"按钮
5. 哈洛加斯城镇 - 红门位置
6. Pindle神殿 - Pindle刷新位置中心
7-9. 从红门到Pindle的传送路径（3个点）

按S键保存，程序会生成坐标文件，复制到 `config.json`

### 步骤2: 配置技能快捷键

**你的当前设置（已配置）**：
- **F1**: 暴风雪 (Blizzard) ❄️
- **F2**: 静态力场 (Static Field) ⚡
- **右键**: 传送 (Teleport) 🌀
- **F3**: 回城卷轴
- **1**: 生命药水
- **2**: 法力药水

**注意**: 程序已针对暴风雪（冰系法师）优化！

### 步骤3: 调整配置文件（已优化）

编辑 `config.json`（已为暴风雪配置）：

```json
{
  "sorceress": {
    "teleport_delay": 0.15,        // 传送间隔（秒）
    "cast_delay": 0.25,            // 施法间隔（秒）
    "static_field_casts": 3,       // 静态力场次数
    "main_attack_skill": "blizzard", // 主攻击：暴风雪
    "blizzard_casts": 4,           // 暴风雪施放次数
    "blizzard_delay": 0.8,         // 暴风雪间隔（秒）
    "use_energy_shield": false,    // 不使用能量护盾
    "mana_threshold": 30           // 法力阈值（%）
  }
}
```

**暴风雪特殊说明**：
- `blizzard_casts`: 4次暴风雪覆盖整个区域
- `blizzard_delay`: 0.8秒等待暴风雪持续伤害
- 总击杀时间约6-8秒（比闪电略慢但更安全）

根据你的FCR调整延迟：
- **FCR 105%+**: teleport_delay=0.12, cast_delay=0.20
- **FCR 63-105%**: teleport_delay=0.15, cast_delay=0.25
- **FCR <63%**: teleport_delay=0.18, cast_delay=0.30

### 步骤4: 测试物品检测
```bash
python test_item_detection.py
```

击杀一次Pindle后运行，查看能否正确识别暗金装备。

### 步骤5: 开始自动刷怪
```bash
python main.py
```

## 法师专用优化

### 战斗策略（冰系暴风雪）
程序采用冰系法师最优战斗流程：
1. 传送到Pindle位置（3次快速传送）⚡
2. 施放3次静态力场降低血量至25% 🌩️
3. 施放4次暴风雪持续冰冻伤害 ❄️
4. 等待暴风雪击杀完成 ⏱️
5. 自动检测并拾取暗金/绿装/符文 💎

**暴风雪优势**：
- AOE范围大，覆盖整个区域
- 持续伤害，确保击杀Pindle及周围小怪
- 冰冻效果，更安全
- 适合冰免以外的所有怪物

### 效率优化（暴风雪版）
- **单局时间**: 约12-18秒（暴风雪需等待持续伤害）
- **传送延迟**: 根据FCR优化（0.12-0.18秒）
- **暴风雪间隔**: 0.8秒（等待伤害tick）
- **拾取范围**: 以Pindle刷新点为中心200像素
- **智能检测**: 只拾取暗金、绿装、符文

**暴风雪 vs 闪电对比**：
| 技能 | 单局时间 | 安全性 | 伤害稳定性 |
|------|----------|--------|------------|
| 暴风雪 | 12-18秒 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ |
| 闪电 | 10-15秒 | ⭐⭐⭐ | ⭐⭐⭐⭐ |

### 安全设置
```json
{
  "bot": {
    "delay_between_runs": 1.2,  // 两局间隔（秒），避免检测
    "runs_count": 500           // 总次数，建议分批运行
  }
}
```

## 常见问题

### Q1: 传送不准确
**A**: 使用 `coordinate_helper.py` 重新获取传送路径的3个点，确保：
- 第1点：红门正前方
- 第2点：走廊中段
- 第3点：Pindle神殿入口

### Q2: 无法拾取物品
**A**: 检查：
1. 运行 `calibrate_colors.py` 校准颜色
2. 确认 `scan_area` 覆盖Pindle掉落区域
3. 调整 `min_detection_area` 和 `max_detection_area`

### Q3: 角色卡住或死亡
**A**: 
- 增加传送延迟 `teleport_delay`
- 确保传送路径避开怪物
- 检查装备抗性是否足够

### Q4: 检测到游戏但无法操作
**A**:
- 确认游戏窗口标题为 "Diablo II: Resurrected"
- 以管理员权限运行脚本
- 关闭杀毒软件干扰

## 进阶技巧

### 1. 多账号轮换
创建多个配置文件：
```bash
python main.py config_account1.json
python main.py config_account2.json
```

### 2. 自定义拾取
只拾取暗金和符文：
```json
"pickup": {
  "item_types": ["unique", "rune"]
}
```

### 3. 记录掉落统计
查看 `bot.log` 文件：
```
[INFO] 拾取物品 1 [unique]: (920, 385)
[INFO] 拾取物品 2 [rune]: (1005, 412)
```

## 预期效率

**法师刷Pindle效率（1920x1080）**:
- 单局时间: 10-15秒
- 每小时: 240-360次
- MF装备: 300-500%

**常见掉落**:
- 暗金装备
- 绿色套装
- 高级符文（Mal+）
- 珠宝、护身符

## 风险提示

⚠️ **使用自动化脚本的风险**:
1. 可能违反游戏服务条款
2. 存在账号封禁风险
3. 建议仅在单机模式或私服使用
4. 请勿在战网使用

**降低风险的建议**:
- 每次运行50-100局后暂停
- 随机化延迟时间
- 不要连续运行超过2小时
- 模拟人类操作习惯

---

**祝你刷出好装备！** 🎮⚡
